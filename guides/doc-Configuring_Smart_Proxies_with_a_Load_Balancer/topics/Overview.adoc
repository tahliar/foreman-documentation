[id='load-balancing-solution-architecture']
= Load Balancing Solution Architecture

You can configure Satellite Server to use a load balancer to distribute client requests and network load across multiple Capsule Servers. This results in an overall performance improvement on Capsule Servers.

This guide outlines how to prepare Satellite Server and Capsule Server for load balancing, and provides guidelines on how to configure a load balancer and register clients in a load-balanced setup.

A load-balanced setup consists of the following components:

* Satellite Server
* Two or more Capsule Servers
* A load balancer
* Multiple clients

[id='satellite-load-balancing-solution-architecture']
.Satellite Load Balancing Solution Architecture

image::satellite_load_balancing_architecture.png[Load Balancing Solution Architecture]

In a load-balanced setup, nearly all Capsule functionality continues to work as expected when one Capsule Server is down, for planned or unplanned maintenance.
Load balancer works with the following services and features:

* Registration using `subscription-manager`
* Content Management with `yum` repositories
* Optional: Puppet

NOTE: Provisioning hosts is not supported in the Satellite load-balanced setup.

.Managing Puppet Limitations

Puppet Certificate Authority (CA) management does not support certificate signing in a load-balanced setup.
Puppet CA stores certificate information, such as the serial number counter and CRL, on the file system. Multiple writer processes that attempt to use the same data can corrupt it.

To manage this Puppet limitation, complete the following steps:

. Configure Puppet certificate signing on one Capsule Server, typically the first system where you configure Capsule Server for load balancing.
. Configure the clients to send CA requests to port 8141 on a load balancer.
. Configure a load balancer to redirect CA requests from port 8141 to port 8140 on the system where you configure Capsule Server to sign Puppet certificates.
